# 第一节 综述

矿车和铁轨最早在Infdev版本的秘密周五更新中作为Minecraft中不可缺少的“挖矿要素”而被加入，在其后的若干版本中得到完善，如同在秘密周五更新的Alpha版本中加入的动力矿车和箱子矿车（运输矿车）、Beta 1.5加入的动力铁轨（充能铁轨）和探测铁轨与1.5加入的漏斗矿车和激活铁轨。1.5加入的刷怪笼矿车、TNT矿车和1.7.2加入的命令方块矿车在本章中只作简要提及。

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-1cf290cf.png)

<!-- TOC depthFrom:1 depthTo:6 withLinks:1 updateOnSave:1 orderedList:0 -->

- [第一节 综述](#第一节-综述)
	- [铁轨的形态](#铁轨的形态)
- [第二节 静态的铁轨分析](#第二节-静态的铁轨分析)
	- [铁路的东南法则](#铁路的东南法则)
	- [弯轨的分析](#弯轨的分析)
- [第三节 矿车动力学](#第三节-矿车动力学)
	- [矿车运行的定性规律](#矿车运行的定性规律)

<!-- /TOC -->

## 铁轨的形态

铁轨会因其所处的位置以及放置的顺序不同而有着不同的形状，具体来说，普通铁轨有着水平直轨，坡度直轨和水平弯轨三种形态；其他铁轨只有直轨的形态。铁轨的下方是其附着，附着被破坏是其也会被破坏，例外是坡度直轨拥有侧面附着，侧面附着被破坏时铁轨也会被破坏。

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-dd0d692d.png)

因此，想要用非普通铁轨直接转弯是不可能的，想要用普通铁轨同时转弯和上坡也是不可能的。如果让普通铁轨同时转弯和上坡，那么企图上坡的矿车会被卡入方块之中。

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-ad446211.png)

# 第二节 静态的铁轨分析

## 铁路的东南法则

在1.15之前，默认放置的单个铁轨总是南北朝向的，但在1.15之后，铁轨总是朝着玩家放置的方向。

铁轨的放置和连接有着与方向有关的优先规律，多个铁轨直接相连的系统可以被称为铁路。与此相关的规律可以被归入东南法则，在本节的若干图例中，如不特别说明，箭头总指向北方。

在1.15中，在已经成形的铁路两侧放置铁轨不会破坏原先的铁路，该铁轨的方向总会与直接放置单个铁轨时的朝向相同——也就是沿玩家的方向。如果新放置的铁轨在原铁路的末端，其首先尝试连接玩家方向的铁轨末端，如果这两个方向上没有铁轨，其尝试连接垂直玩家方向的铁路末端。如果将铁轨末端变为南北朝向不破坏任何已有的铁路结构，其可以将毗邻的铁路末端变为南北朝向；将铁轨末端变为东西朝向总会是成功的。总结而言，**铁轨总优先尝试按照玩家的方向放置，但铁路总优先保持东西朝向**。坡度直轨对这条规律没有影响。

*例 面朝北方，在橙色混凝土上放置动力铁轨，判断铁路的最终形状。如果面朝西方，再次判断。*

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-ab2b44e8.png)

*铁轨总优先尝试按照玩家的方向放置，因此其与南北朝向的动力铁轨连接，被南北放置。面朝西方得到的结果是相同的。*

*例 面朝北方，依次在橙色混凝土和品红色混凝土上放置动力铁轨，判断铁路的最终形状。如果面朝西方，再次判断*

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-1e468cd8.png)

*面朝北方放置橙色铁轨时，南北方向没有铁轨末端，其只能东西连接，并将西侧铁轨变为东西向。当在放置品红色铁轨时，其会优先连接南侧橙色混凝土上的铁轨，故其南北放置。结果如下，其中箭指向北方。*

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-31b6a13d.png)

*面朝西方时，橙色铁轨因左下侧的铁轨而成为东西走向，但其不会改变左下侧铁轨的朝向。当放置品红色铁轨时，其尝试改变橙色铁轨的指向，使之成为东西朝向。结果如下，其中箭指向北方。*

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-ba631b33.png)

*例 面朝北方，在橙色混凝土上放置动力铁轨，判断铁路的最终形状。如果面朝西方，再次判断。*

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-8b0445f5.png)

*必须注意，原铁路的末端仅有橙色铁轨的左侧和右侧，因此铁轨总会被左右放置，但只有南北朝向时能改变左右两侧铁轨朝向。结果如下，其中箭指向北方。*

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-0d04f5e5.png)

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-e432524d.png)

*例 尝试在地面密铺3×3的东西朝向的铁轨。*

由于铁路总会优先保持东西走向，故只需要面朝西方或东方，沿东西方向铺设一条铁路，再铺设另外两条铁路即可。如果第二条铁路最先铺设在第一条铁路的末端，其会暂时变为南北指向，但第二条铁路的其他铁轨会纠正这一个错误。

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-6d9fea4a.png)

*例 尝试在地面密铺3×3的南北朝向的铁轨，不允许在范围之外放置铁轨。*

*显然在铺设铁路时不能过于随意，不能在前一条铁轨的末端两侧铺设第二条铁轨，否则如果按照从上到下，从左到右的顺序铺设时会出现以下问题：*

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-2f99e576.png)

*在铺设时应当先铺设铁轨的中间部分，再从中间部分延长至末端。*

铁轨被活塞推动，相当于在推动到位的位置直接放置原形态的铁轨，当多个铁轨被推动时，推动到位的次序自然应当用活塞推动方块次序的规律进行判断。

*例 面朝北方，分别拉下两个拉杆，判断铁路最终的形状。*

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-265d37bb.png)

*当拉下上侧拉杆时，下侧铁轨先到位，保持南北放置。随后上侧铁轨到位，与下侧铁轨连接，结果如下。*

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-aee31b49.png)

*当拉下上侧拉杆时，上侧铁轨先到位，优先东西连接。随后下侧铁轨到位，南北连接，但不能改变上侧铁轨的朝向。*

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-911659f4.png)

在1.15前，铁路保持东西走向比铁轨连接南北走向具有更高的优先级，换句话说，**铁路总优先形成东西朝向，在不能呈东西朝向时才会沿南北朝向**。

出于此，仅在3×3范围内操作就在其内密铺南北朝向的动力铁轨时不可能的，因为一旦放置一个铁轨末端，再在其毗邻放置的铁轨总会使其成为东西朝向。这种情况下可以用延长铁路，避免末端接触的方法密铺南北朝向的铁路。

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-ab529fff.png)

## 弯轨的分析

普通铁轨的铺设与动力铁轨的铺设有着类似的规律，唯一的不同是普通铁轨具有弯轨这一特殊形态。当普通铁轨被放置时，如果其可以形成弯轨，其会优先形成弯轨，弯轨总会优先连接东侧和南侧。这一规律同样可以归入东南法则。

非常特殊的一点是，如果弯轨的三个方向有其他铁轨，红石信号可以控制弯轨的弯曲方向，弯轨未激活时优先连接东侧和南侧，弯轨激活时会优先连接西侧和北侧。但是如果弯轨的四个方向都有铁轨，红石信号对其没有作用。出于这一点，可以不把弯轨作为红石元件。

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-cbf721f5.png)

如果铁轨因放置或红石指向BUG处于不正常的状态（或称BUD态），这种状态只能由部分红石信号改变，如红石线直接指向、拉杆、观察者等(红石块会激活弯轨，但激活这一过程不会更新铁轨，暂不清楚这是否是一个BUG)，普通的方块更新不会使其回归正常的状态。

下面介绍连续弯轨和交叉弯轨，其本质上是多个弯轨的重复。下图左侧是一个朝前的偏向右侧的连续弯轨，每一个弯轨连接右侧和前侧，因此矿车可以从后向前运行，但从前方来的矿车会到达右侧而脱离铁轨。下图右侧是交叉弯轨，连接右侧和前侧的弯轨和连接前侧和左侧的弯轨交替出现，同样可以使后方来的矿车向前运行，但不能让矿车从前方向后运行。

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-0afede77.png)

布置一个连接前侧和右侧的弯轨，必须先在前侧和右侧放置铁轨，使其弯向前侧和右侧，随后再破坏多余辅助的铁轨，这就意味着弯轨连续弯轨或交叉弯轨只能向由后向前逐个铺设。同时，铺设新的弯轨时，旧的弯轨不能收到影响，这就意味着后方的弯轨处于西侧或北侧，因而，向东方和南方铺设连续弯轨或交叉弯轨只需要按部就班地逐个铺设即可。

铺设朝向北方或西方的连续弯轨或交叉弯轨需要辅以红石信号：在不放置铁轨的一侧放置红石信号源，保证新放置的弯轨处于激活态，连接前方而不是后方已铺设的弯轨。铺设完毕后，先去除多余辅助的铁轨，再去除红石信号源，保证弯轨不会因撤销信号而改变形态。

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-21cf3874.png)

如果一条直轨铁路已经铺设完成了，如何将它们变为连续弯轨或交叉弯轨呢？在这种情况下，唯一能够变更弯轨的弯向，使之变为激活态或未激活态的方法是用红石信号更新它们。如下的装置可以将朝南或朝东的一列直轨变为连续弯轨。如果要铺设朝西和朝北的连续弯轨，可以在观察者前放置红石块，使其被更新为激活态。

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-cadd92d9.png)

交叉弯轨的制作稍为复杂，需要两个如上图的装置间隔运行，这就要求制作一个每两格触发一次的装置，在[粘液块及观察者技术](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/blob/master/粘液块及观察者技术.md)中我们介绍了类似的装置。如下是ilmango给出的一种设计。

[^_^]:https://www.bilibili.com/video/av23620138

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-2cb77c8d.png)

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-e94acf25.png)

同样，如果需要朝西方或北方制作连续弯轨，需要在观察者前加红石块。

连续弯轨和交叉弯轨最早被应用于生存电路，用活塞在交叉弯轨上推动矿车，达到20m/s的速度。这种技术至少在2013年就得到了应用。

下面尝试铺设如下形状的铁路线。

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-5a68f2a3.png)

难点在于弯轨。铺设下层的前右弯轨时，必须首先放置后侧和右侧的铁轨，因此本铁路应当从左向右铺设。如果面朝东方或南方，铺设下层的前右弯轨时，如果上层靠右弯轨已经铺设好了，其会主动连接前侧，也就是上层靠右弯轨，因此必须先铺设下层弯轨。但此时上层的靠右弯轨就没有机会弯向左侧和后侧了，除非使用一个浮空的方块加铁轨作为辅助。

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-2748c890.png)

如果是面朝南方或西方，该浮空方块的拆除需要推迟，至少要等下一单元的上层靠左弯轨铺设完毕，否则其会影响这一单元的靠右上层弯轨。

这种铁路的铺设方式并不唯一，例如玩家可以在下图的基础上继续修改，完成本铁路。

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-397541be.png)

在1.15前，铁路的东西向连接具有很强的优先级，在东西方向铺设本铁路还是一件比较容易的事，只需要注意不断右移用来延长铁路以避免末端接触的辅助铁轨即可。但南北方向铺设该铁路难度较高，下面给出一种利用粘性活塞的方式。

首先按如下形式铺设铁路，再从左到右地依次激活并撤销激活粘性活塞。

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-6b5a52e7.png)

上层铁轨被拉至下方，这一过程会使得两侧的普通铁轨弯向坡度动力铁轨。从左到右地拉动铁轨，就可以使普通铁轨统一弯向右侧了。

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-1b668095.png)

随后的铁路布局可以参考本节借用辅助方块的部分。

# 第三节 矿车动力学

矿车动力学是研究矿车在铁路之上运行规律的理论。研究表明，矿车在铁轨上的运行和一般实体的平面移动与落体运动并没有运行模式上的区别，但关键在于矿车的运动被铁轨局限于铁路之上，且矿车在每一游戏刻的运动主要取决于其下铁轨的状态。Octopuscraft的Mackler在2014年2月发布的《关于矿车系统的研究与应用》中对铁轨及矿车系统做了基础性的剖析，并给出了若干极具启发意义的实际应用与设计。nenn发布在RedstoneMachineryCommunication的一系列论文通过详实严谨的数据从实验角度阐明了矿车运行的规律，并给出基于理论分析的若干实际应用及实践方向。

## 矿车运行的定性规律

首先我们研究矿车从一条铁路驶出，又驶入另一条铁路时的运行方向具有怎样的规律。铁轨的形态有弯轨、平面直轨、坡度直轨三种，下面分别进行叙述。

矿车从一条铁路驶向另一条铁路的弯轨时，总会沿原先的运动方向前进。

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-8ca4dd72.png)

矿车从一条铁路驶向另一条铁路的直轨时，总会朝东方或南方前进，这一点可以被归入东南法则。

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-1cb0d049.png)

矿车从一条铁路驶向另一条铁路的坡度直轨时，总会下坡前进。

了解如上的三条规律，可以更好的把握矿车在从一条铁路进入另一条铁路时的运行方向。如下的铁路充分利用的矿车驶入直轨和坡度轨时的规律，其研究是一个很有趣的课题——不使用弯轨如何使矿车可以双向地转弯。以下三张图分别给出了东—南、东—北和西—北转弯的一种设计。

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-aaa7e1a3.png)

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-aafbb091.png)

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-1325975c.png)

与红石线类似地，矿车也有可能被“压线”，也就是被阻挡在坡度直轨上。但特殊的是，下图中的红色混凝土可以阻挡从上至下的矿车，黄绿色混凝土却无法阻挡。另外，只要矿车具有足够的速度，任何方块都无法阻挡从下向上运行的矿车。

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-a8ac3059.png)

一个基于此的有用的设计是存储矿车的自动队列，矿车被栅栏门阻挡，而前一存储单元的探测铁轨控制后裔存储单元的栅栏门。矿车从左侧入队并依次存储，而从右侧人为控制取出一只矿车时，所有矿车右移一个单元继续存储。

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-ee7288f7.png)

在开始研究矿车的运行速度之前，我们有必要了解实体如何存储自身的位置及速度。

矿车的实体数据中包含Pos和Motion两项，分别表示矿车的位置和速度，其x、y、z三个分量对应位置矢量和速度矢量的三个分量，其在计算机中使用double类型存储。

首先对动力铁轨的加速作用进行分析。必须注意到以下的一个事实：动力铁轨对普通矿车的加速存在阈值，这个速度称为饱和速度。例如在如下的对比实验中，两辆矿车同时出发，其中一辆不断受到动力铁轨的加速，另一辆只接受4个动力铁轨的加速。事实是，在第二辆矿车离开动力铁轨的一段时间内，其和第一辆矿车保持同速。

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-5debd37a.png)

换句话说，更多动力铁轨的加速不会使矿车获得更高的速度，但却可以使矿车移动更长的距离。4个动力铁轨可以使矿车在普通铁轨上移动8.62格，5个动力铁轨则是13.27格。

![](https://github.com/Xiaoyuan-xyz/The-Principle-of-Redstone-Circuits/raw/master/Illustration/铁轨及矿车系统/铁轨及矿车系统-ccbad9b7.png)

这两个实验说明，矿车存在一个“隐速度”，其表征矿车运动的快慢和能力，但矿车的真实速度却被限制在了饱和速度。
